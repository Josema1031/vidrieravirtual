<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>MATES GUAY</title>
  <link rel="stylesheet" href="style.css" />
  <link rel="shortcut icon" href="imag/logo.png" type="image/x-icon">

  <!-- Open Graph Meta Tags -->
  <meta property="og:title" content="Mates Guay - Mates y Accesorios de Calidad" />
  <meta property="og:description" content="Descubr√≠ nuestros mates, bombillas y accesorios artesanales. ¬°Env√≠os a todo el pa√≠s!" />
  <meta property="og:image" content="https://josema1031.github.io/matesguay/imag/logo_600x315.png" />
  <meta property="og:url" content="https://josema1031.github.io/matesguay/" />
  <meta property="og:type" content="website" />
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Mates Guay - Mates y Accesorios de Calidad">
  <meta name="twitter:description" content="Descubr√≠ nuestros mates, bombillas y accesorios artesanales. ¬°Env√≠os a todo el pa√≠s!">
  <meta name="twitter:image" content="https://josema1031.github.io/matesguay/imag/logo_600x315.png">
</head>

<body>
  
  <div id="loader" style="
    position: fixed; top: 0; left: 0;
    width: 100%; height: 100%;
    background: #fff; display: flex;
    justify-content: center; align-items: center;
    font-family: sans-serif; font-size: 1.2em;
    z-index: 9999; color: #333;">
    Cargando tu tienda...
  </div>

  <!-- ‚úÖ HEADER DIN√ÅMICO -->
  <header id="header-tienda" style="
    display:flex; align-items:center; justify-content:center;
    gap:20px; padding:20px; flex-wrap:wrap;
    background:#007bff; color:white;">
    <img id="logo-tienda" src="" alt="Logo tienda" style="
      height:110px; width:auto; object-fit:contain;
      border-radius:10px; box-shadow:0 4px 10px rgba(0,0,0,0.3);
      transition:transform 0.25s ease, filter 0.25s ease;
      filter:drop-shadow(0 3px 6px rgba(0,0,0,0.25));">
    <h1 id="nombre-tienda" style="
      margin:0; font-size:2.6rem; font-weight:900;
      text-shadow:0 2px 5px rgba(0,0,0,0.4);
      letter-spacing:1px;"></h1>
  </header>

 <!-- <p style="text-align:center; margin-top:8px; font-size:1.1rem; font-weight:500; color:#222;">
    Dise√±o, tradici√≥n y sabor en un solo mate
  </p>-->


<!-- MEN√ö DE CATEGOR√çAS DIN√ÅMICAS -->
<div id="menu-categorias"></div>


  <!-- PRODUCTOS -->
  <main>
    <input type="text" id="buscador" placeholder="Buscar productos..." style="width: 35%; padding: 10px; margin-bottom: 20px; font-size: 16px;">
    <div class="productos" id="contenedor-productos"></div>
    <div style="text-align:center; margin: 20px;">
      <button id="btn-mostrar-mas" onclick="mostrarMasProductos()">Mas productos</button>
    </div>
  </main>

  <!-- CARRITO -->
  <div id="carrito-flotante">
    <button id="toggle-carrito">üõí Carrito (<span id="contador-carrito">0</span>)</button>
    <div id="carrito-contenido" class="oculto">
      <h2>Carrito de Compra</h2>
      <ul id="lista-carrito"></ul>
      <p id="total">Total: $0</p>
      <button id="btn-vaciar" style="background: gray; color: white; margin-top: 10px;">Vaciar carrito</button>
      <button id="btn-enviar">Enviar pedido por WhatsApp</button>
    </div>
  </div>

  <!-- MODAL PRODUCTO -->
  <div id="modal-producto" class="modal oculto">
    <div class="modal-contenido">
      <span class="cerrar" onclick="cerrarModal()">&times;</span>
      <img id="modal-imagen" src="" alt="" style="max-width: 100%; border-radius: 8px;">
      <h2 id="modal-nombre"></h2>
      <p id="modal-precio"></p>
      <p id="modal-descripcion"></p>
      <button id="modal-agregar">Agregar al carrito</button>
    </div>
  </div>

 <p id="contador-visitas" style="text-align:center; color:#444; font-size:14px; margin-top:10px;">
  üëÅÔ∏è Visitas: <span id="contador-visitas-numero">0</span>
</p>



  <!-- FOOTER -->
  <footer id="footer" style="text-align:left; padding:20px; background:#003366; color:white;">
    <p><strong>üìç Ubicaci√≥n:</strong> Calle Juan Castares N¬∞ 374, Gualeguay (ER)</p>
    <p><strong>üïí Horario de atenci√≥n:</strong> Lunes a Viernes de 8:30 a 12:30 y S√°bado de 08:00 a 10:00 hs</p>
  </footer>

  <!-- SCRIPT PRINCIPAL -->
  <script type="module" src="js/script.js"></script>

  <!-- CONFIGURACI√ìN FIREBASE -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
    import { getFirestore, doc, getDoc } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "AIzaSyA36uwBk0FBDc6rI16BAsqUNe_AXLpv62Q",
      authDomain: "carniceriadonjose-48638.firebaseapp.com",
      projectId: "carniceriadonjose-48638",
      storageBucket: "carniceriadonjose-48638.appspot.com",
      messagingSenderId: "322531750471",
      appId: "1:322531750471:web:78e290c9c81eecc7be3762"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    // üîç Obtener tiendaId
    function getTiendaId() {
      const params = new URLSearchParams(window.location.search);
      const fromUrl = params.get("tienda");
      if (fromUrl) {
        localStorage.setItem("tiendaId", fromUrl);
        return fromUrl;
      }
      return localStorage.getItem("tiendaId") || "MATES-GUAY";
    }
    const tiendaId = getTiendaId();

    // üìÑ Cargar configuraci√≥n
    async function cargarConfig() {
      const ref = doc(db, "tiendas", tiendaId, "config", "datos");
      const snap = await getDoc(ref);
      if (!snap.exists()) return null;
      return snap.data();
    }

    // üß† Aplicar configuraci√≥n visual
    async function aplicarConfig() {
      const cfg = await cargarConfig();
      if (!cfg) return;
      

      // Header
      const header = document.getElementById("header-tienda");
      const logoEl = document.getElementById("logo-tienda");
      const nombreEl = document.getElementById("nombre-tienda");

      header.style.background = cfg.colorHeader || "#007bff";
      header.style.color = cfg.colorHeaderText || "#ffffff";

      // Logo
      if (cfg.logo && logoEl) {
        logoEl.src = cfg.logo;
        logoEl.alt = cfg.nombre || tiendaId;
        logoEl.style.display = "block";
      } else {
        logoEl.src = "https://via.placeholder.com/100x100?text=Logo";
        logoEl.alt = "Logo gen√©rico";
      }

      logoEl.style.height = "110px";
      logoEl.style.width = "auto";
      logoEl.style.objectFit = "contain";
      logoEl.style.borderRadius = "10px";
      logoEl.style.boxShadow = "0 4px 10px rgba(0,0,0,0.3)";
      logoEl.style.transition = "transform 0.25s ease, filter 0.25s ease";
      logoEl.style.filter = "drop-shadow(0 3px 6px rgba(0,0,0,0.25))";
      logoEl.onmouseover = () => (logoEl.style.transform = "scale(1.08)");
      logoEl.onmouseout = () => (logoEl.style.transform = "scale(1)");

      // Nombre
      nombreEl.textContent = cfg.nombre || "Mi Tienda";
      nombreEl.style.color = cfg.colorHeaderText || "#ffffff";
      nombreEl.style.fontSize = "2.6rem";
      nombreEl.style.fontWeight = "900";
      nombreEl.style.textShadow = "0 2px 4px rgba(0,0,0,0.3)";

      // Footer
      const footer = document.getElementById("footer");
      if (footer) {
        footer.style.background = cfg.colorFooter || "#003366";
        footer.style.color = cfg.colorFooterText || "#ffffff";
        footer.innerHTML = `
          <p><strong>üìç Direcci√≥n:</strong> ${cfg.direccion || "Sin direcci√≥n especificada"}</p>
          <p><strong>üïí Horario:</strong> ${cfg.horarios || "Horario no disponible"}</p>
          <p><strong>üìû WhatsApp:</strong> 
            <a href="https://wa.me/${cfg.whatsapp}" target="_blank" style="color:${cfg.colorFooterText || "#fff"};">
              ${cfg.whatsapp}
            </a>
          </p>
        `;
      }

      // Bot√≥n carrito
      const btnCarrito = document.getElementById("toggle-carrito");
      if (btnCarrito && cfg.colorBoton) {
        btnCarrito.style.background = cfg.colorBoton;
        btnCarrito.style.border = "none";
        btnCarrito.style.color = "#000";
        btnCarrito.style.fontWeight = "600";
      }
      // üè∑Ô∏è Cambiar color del t√≠tulo
if (cfg.colorTitulo) {
  const titulo = document.querySelector(".titulo-tienda, h1, h2");
  if (titulo) titulo.style.color = cfg.colorTitulo;
}

      // ============================================
// üé® NUEVAS CONFIGURACIONES VISUALES
// ============================================

// üõí Cambiar color del bot√≥n flotante del carrito (colorCarrito)
if (cfg.colorCarrito) {
  const botonCarrito = document.getElementById("toggle-carrito");
  if (botonCarrito) {
    botonCarrito.style.backgroundColor = cfg.colorCarrito;
    botonCarrito.style.borderColor = cfg.colorCarrito;

    // Detectar brillo del color para texto legible (blanco o negro)
    const rgb = parseInt(cfg.colorCarrito.replace("#", ""), 16);
    const r = (rgb >> 16) & 255;
    const g = (rgb >> 8) & 255;
    const b = rgb & 255;
    const brillo = (r * 299 + g * 587 + b * 114) / 1000;
    botonCarrito.style.color = brillo < 140 ? "#fff" : "#000";
  }
}

// ‚úèÔ∏è Cambiar color del texto del footer (Direcci√≥n, Horario, WhatsApp)
if (cfg.colorTexto) {
  const footer = document.getElementById("footer");
  if (footer) {
    footer.querySelectorAll("p, a, strong").forEach(el => {
      el.style.color = cfg.colorTexto;
    });
  }
}


      document.title = cfg.nombre || "Tienda";
    }

    aplicarConfig();
  </script>
</body>
</html>
