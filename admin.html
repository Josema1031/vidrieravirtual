<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Panel de AdministraciÃ³n</title>
  <link rel="shortcut icon" href="imag/LOGO-ADMIN.png" type="image/x-icon">
  <link rel="stylesheet" href="styleadmin.css">


</head>

<body>

  <!-- Login -->
  <div id="login-container" style="max-width:420px; margin:60px auto; background:#fff; padding:40px 25px 50px 25px; border-radius:16px;
         box-shadow:0 8px 24px rgba(0,0,0,0.12); text-align:center; font-family:system-ui, sans-serif;">

    <div id="loader" style="display:none; text-align:center; margin-top: 20px;">
      <p>Cargando autenticaciÃ³n...</p>
    </div>

    <h1 style="font-size:22px; color:#111; margin-bottom:18px;">
      Panel de AdministraciÃ³n de Productos -
      <span id="MATES-GUAY" style="font-weight:800; color:#0b5ed7;"></span>
    </h1>

    <!-- Campos -->
    <input type="email" id="email" placeholder="Correo electrÃ³nico"
      style="width:100%; padding:10px; border:1px solid #ccc; border-radius:8px; margin-bottom:12px; font-size:15px;"><br>

    <div style="position: relative; display: flex; align-items:center; justify-content:center;">
      <input type="password" id="password" placeholder="ContraseÃ±a"
        style="width:100%; padding:10px; border:1px solid #ccc; border-radius:8px; font-size:15px;">
      <span onclick="togglePassword()"
        style="position:absolute; right:12px; cursor:pointer; color:#555; font-size:17px;">ğŸ‘ï¸</span>
    </div>

    <!-- BotÃ³n ingresar -->
    <button onclick="login()" style="margin-top:18px; background:#0b5ed7; color:white; border:none; border-radius:8px; 
           padding:10px 18px; cursor:pointer; font-weight:600; font-size:15px; width:80%; 
           transition:all 0.3s ease;">
      Ingresar
    </button>

    <p id="mensaje-error" style="color:red; margin-top:10px;"></p>
    <p id="mensaje-exito" style="color:green; font-weight:bold; display:none;"></p>

    <hr style="margin:22px 0; border:none; border-top:1px solid #eee;">

    <!-- Crear cuenta -->
    <div style="margin-top:10px;">
      <p style="margin-bottom:6px; color:#333; font-size:15px;">Â¿No tenÃ©s cuenta todavÃ­a?</p>
      <button id="btnCrearCuenta" onclick="registrarUsuario()" style="background:#198754;color:white;padding:10px 16px;border:none;
             border-radius:8px;cursor:pointer;font-weight:600;width:80%;
             font-size:15px; transition:all 0.3s ease;">
        Crear cuenta nueva
      </button>

    </div>



    <!-- Recuperar contraseÃ±a -->
    <div style="margin-top:16px;">
      <p style="margin-bottom:6px; color:#333; font-size:15px;">Â¿Olvidaste tu contraseÃ±a?</p>
      <button onclick="recuperarContrasena()" style="background:#f59e0b;color:white;padding:10px 16px;border:none;
             border-radius:8px;cursor:pointer;font-weight:600;width:80%;
             font-size:15px; transition:all 0.3s ease;">
        Recuperar contraseÃ±a
      </button>
    </div>
  </div>


  <!-- Panel oculto hasta que se loguee -->
  <div id="admin-panel">


    <h1>Panel de AdministraciÃ³n de Productos</h1>

    <div id="acciones" style="display:flex; flex-wrap:wrap; justify-content:center; gap:10px; margin-top:20px;">
      <button onclick="agregarProducto()"
        style="background:#0b5ed7; color:white; border:none; padding:10px 18px; border-radius:8px; cursor:pointer; font-size:15px; font-weight:600; transition:all 0.3s ease;">
        â• Agregar Producto
      </button>

      <button onclick="guardarProductos()"
        style="background:#198754; color:white; border:none; padding:10px 18px; border-radius:8px; cursor:pointer; font-size:15px; font-weight:600; transition:all 0.3s ease;">
        ğŸ’¾ Guardar Cambios
      </button>
      <button id="btnGenerarFolleto" style="background:#0dcaf0; color:white; border:none; padding:10px 18px;
  border-radius:8px; cursor:pointer; font-size:15px; font-weight:600;
  transition:all 0.3s ease;">
        ğŸ§¾ Generar Folleto PDF
      </button>


      <button onclick="cerrarSesion()"
        style="background:#dc3545; color:white; border:none; padding:10px 18px; border-radius:8px; cursor:pointer; font-size:15px; font-weight:600; transition:all 0.3s ease;">
        ğŸ”’ Cerrar sesiÃ³n
      </button>

      <!-- ğŸ“‡ Registro de Clientes / Proveedores (Solo Premium) -->
      <button id="btnRegistroClientes" style="background:#6610f2; color:white; border:none; padding:10px 18px; border-radius:8px;
         cursor:pointer; font-size:15px; font-weight:600; transition:all 0.3s ease; display:none;">
        ğŸ“‡ Registro Clientes / Proveedores
      </button>


      <button id="btnConfigTienda"
        style="background:#6c757d; color:white; border:none; padding:10px 18px; border-radius:8px; cursor:pointer; font-size:15px; font-weight:600; transition:all 0.3s ease;">
        âš™ï¸ ConfiguraciÃ³n de la Tienda
      </button>

    </div>


    <div id="dashboard">
      <div class="card">
        <h3>Total de productos</h3>
        <p id="total-productos">0</p>
      </div>
      <div class="card low-stock-card">
        <h3>Stock bajo</h3>
        <p id="productos-bajo-stock">0</p>
      </div>
      <div class="card no-stock-card">
        <h3>Sin stock</h3>
        <p id="productos-sin-stock">0</p>
      </div>
    </div>

    <p id="plan-actual" style="text-align:center;font-weight:700;margin:10px 0 4px;color:#0b5ed7;"></p>
    <p id="plan-beneficios" style="text-align:center;margin:0;color:#444;font-size:14px;"></p>

    <!-- ğŸ’¼ BotÃ³n Cambiar / Actualizar Plan -->
    <div id="boton-cambiar-plan" style="text-align:center; margin:10px 0; display:none;">
      <button id="btnCambiarPlan"
        style="background:#f59e0b; color:white; border:none; padding:10px 20px; border-radius:8px; cursor:pointer; font-weight:bold;">
        ğŸ”„ Cambiar / Actualizar Plan
      </button>
    </div>



    <!-- ğŸ”½ Modal de selecciÃ³n -->
    <div id="modalCambiarPlan"
      style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.4);">
      <div
        style="background:white; width:90%; max-width:400px; margin:100px auto; padding:20px; border-radius:12px; text-align:center;">
        <h3>SeleccionÃ¡ el nuevo plan</h3>
        <p style="color:#444;">ElegÃ­ a cuÃ¡l plan querÃ©s actualizar:</p>
        <button id="btnSubirProfesional"
          style="background:#10b981; color:white; border:none; padding:10px 18px; border-radius:8px; margin:5px;">Profesional
          ğŸ’¼</button>
        <button id="btnSubirPremium"
          style="background:#0b5ed7; color:white; border:none; padding:10px 18px; border-radius:8px; margin:5px;">Premium
          ğŸš€</button>
        <div style="margin-top:10px;">
          <button id="btnCerrarModal"
            style="background:#ccc; color:black; border:none; padding:6px 14px; border-radius:6px;">Cancelar</button>
        </div>
      </div>
    </div>

    <p id="mensaje-confirmacion-plan"
      style="text-align:center; color:green; font-weight:bold; display:none; margin-top:10px;">
      âœ… Solicitud enviada correctamente por WhatsApp.
    </p>





    <!-- ğŸ’µ Registro de Ventas y Cierre de Caja (Solo Plan Premium) -->
    <section id="panel-ventas"
      style="display:none; margin-top:30px; background:#f5f5f5; padding:25px; border-radius:12px; box-shadow:0 4px 15px rgba(0,0,0,0.08);">
      <h2 style="text-align:center; color:#0b5ed7; margin-bottom:20px;">ğŸ’µ Registro de Ventas y Cierre de Caja</h2>

      <div style="display:flex; flex-wrap:wrap; gap:10px; justify-content:center; margin-bottom:25px;">
        <input list="listaProductos" id="productoVendido" placeholder="Producto vendido..."
          style="padding:10px 12px; border:1px solid #ccc; border-radius:8px; width:220px; font-size:15px;">
        <datalist id="listaProductos"></datalist>

        <input type="number" id="montoVenta" placeholder="Monto ($)"
          style="padding:10px 12px; border:1px solid #ccc; border-radius:8px; width:140px; font-size:15px;">
        <button id="btnRegistrarVenta"
          style="background:#198754; color:white; border:none; padding:10px 20px; border-radius:8px; cursor:pointer; font-weight:600;">
          â• Registrar Venta
        </button>
      </div>

      <table id="tablaVentas" style="width:100%; border-collapse:collapse;">
        <thead>
          <tr style="background:#0b5ed7; color:white;">
            <th style="padding:10px;">Fecha</th>
            <th style="padding:10px;">Producto</th>
            <th style="padding:10px;">Monto</th>
            <th style="padding:10px;">Acciones</th> <!-- âœ… NUEVA COLUMNA -->
          </tr>
        </thead>
        <tbody></tbody>
      </table>


      <p id="totalCaja" style="text-align:center; margin-top:20px; font-weight:bold;">Total del dÃ­a: $0</p>

      <div style="text-align:center; margin-top:20px;">
        <button id="btnCierreCaja"
          style="background:#f59e0b; color:white; border:none; padding:10px 20px; border-radius:8px; cursor:pointer; font-weight:bold;">
          ğŸ“¦ Cerrar Caja
        </button>
      </div>
    </section>

    <!-- ğŸ·ï¸ SecciÃ³n de CategorÃ­as -->
    <section id="categorias-panel"
      style="margin-top:30px; background:#fff; padding:20px; border-radius:12px; box-shadow:0 6px 20px rgba(0,0,0,0.08);">
      <h2>ğŸ·ï¸ CategorÃ­as de Productos</h2>
      <p style="color:#555;">AgregÃ¡, eliminÃ¡ o renombrÃ¡ las categorÃ­as segÃºn tus productos haciendo doble click:</p>

      <div id="lista-categorias" style="display:flex; flex-wrap:wrap; gap:10px; margin-bottom:15px;"></div>
      <div style="display:flex; flex-wrap:wrap; gap:8px; align-items:center;">
        <input type="text" id="nuevaCategoria" placeholder="Nueva categorÃ­a..."
          style="flex:1; min-width:180px; padding:10px; border:1px solid #ccc; border-radius:8px; font-size:15px;">

        <button id="btnAgregarCategoria"
          style="background:#0b5ed7; color:white; border:none; padding:8px 12px; border-radius:8px; font-weight:600; cursor:pointer; font-size:14px; white-space:nowrap;">
          â• Agregar
        </button>
      </div>

    </section>

    <!-- âœ… Mensaje de confirmaciÃ³n animado -->
    <p id="mensaje-confirmacion-categorias"
      style="display:none; text-align:center; color:green; font-weight:bold; margin-top:10px;">
      âœ… Cambios guardados correctamente.
    </p>




    <!-- CDN Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <p id="mensaje-limite" style="text-align:center; margin-top:10px; font-weight:600; color:#007bff;">
    </p>

    <div style="text-align: center; margin-top: 20px;">
      <input type="text" id="buscador-admin" placeholder="Buscar productos...">

    </div>
    <div class="tabla-contenedor">
      <table id="tabla-productos">
        <thead>
          <th>Nombre</th>
          <th>Precio</th>
          <th>Precio Anterior</th>
          <th>% Descuento</th>
          <th>Precio Mayorista</th>
          <th>Unidades por Pack</th>
          <th>CategorÃ­a</th>
          <th>Cantidad</th>
          <th>Tipo de venta</th>
          <th>Imagen (URL)</th>
          <th>Acciones</th>
          <th>Stock</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>
    <div id="paginacion" style="text-align:center; margin-top:20px;"></div>
    <hr style="margin:30px 0;">
  </div>

  <section id="configuracion-tienda"
    style="display:none; background:#fff; padding:20px; border-radius:12px; box-shadow:0 8px 24px rgba(0,0,0,0.08);">
    <h2>âš™ï¸ ConfiguraciÃ³n de la Tienda</h2>

    <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(240px,1fr));gap:16px;margin-top:15px;">

      <div>
        <label>Nombre de la tienda:</label>
        <input type="text" id="nombreTienda" class="campo-config">
      </div>

      <div>
        <label>WhatsApp:</label>
        <input type="text" id="whatsappTienda" class="campo-config">
      </div>

      <div>
        <label>DirecciÃ³n:</label>
        <input type="text" id="direccionTienda" class="campo-config">
      </div>

      <div>
        <label>Horarios:</label>
        <input type="text" id="horariosTienda" class="campo-config">
      </div>

      <div>
        <label for="tituloTienda">TÃ­tulo principal de la tienda:</label>
        <input type="text" id="tituloTienda" class="campo-config" placeholder="Ej: Mates Guay - Tienda Oficial">
      </div>

      <div>
        <label>Color Banner inferior:</label>
        <input type="color" id="colorHeaderTienda" class="campo-config">
      </div>

      <div>
        <label>Color Banner superior:</label>
        <input type="color" id="colorFooterTienda" class="campo-config">
      </div>

      <div>
        <label for="colorTituloTienda">ğŸ¨ Color del tÃ­tulo:</label>
        <input type="color" id="colorTituloTienda" value="#000000">
      </div>

      <div>
        <label>Color del carrito:</label>
        <input type="color" id="colorCarritoTienda" value="#ff6b00">
      </div>

      <div>
        <label>Color del texto (descripciones):</label>
        <input type="color" id="colorTextoTienda" value="#333333">
      </div>

      <div>
        <label>Logo actual:</label><br>
        <img id="logoPreview" src=""
          style="height:60px;border-radius:8px;object-fit:contain;background:#f5f5f5;padding:6px;">
        <input type="file" id="logoTienda" accept="image/*" style="margin-top:8px;">
        <br>
        <label style="margin-top:8px;display:block;">O usar URL del logo:</label>
        <input type="url" id="logoUrlTienda" placeholder="https://ejemplo.com/logo.png"
          style="width:100%;padding:6px;border-radius:6px;border:1px solid #ccc;">
      </div>

      <div>
        <label>ğŸ›’ Mostrar carrito:</label><br>
        <input type="checkbox" id="mostrarCarritoTienda">
        <span id="estadoCarritoLabel">Activo</span>
      </div>


    </div>

    <div style="text-align:center;">
      <button id="btnGuardarConfig"
        style="margin-top:20px;padding:10px 18px;border:none;border-radius:8px;background:#007bff;color:#fff;cursor:pointer;">ğŸ’¾
        Guardar configuraciÃ³n</button>
    </div>
  </section>

  <!-- ğŸ”§ Modal ConfiguraciÃ³n de Tienda -->
  <div id="modalConfigTienda"
    style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.5); z-index:999;">
    <div
      style="background:#fff; max-width:900px; width:95%; margin:40px auto; border-radius:12px; padding:20px; overflow-y:auto; max-height:90vh;">
      <h2 style="text-align:center;">âš™ï¸ ConfiguraciÃ³n de la Tienda</h2>
      <button id="btnCerrarConfig"
        style="position:absolute; right:20px; top:20px; background:#dc3545; color:#fff; border:none; border-radius:6px; padding:6px 10px; cursor:pointer;">
        âœ– Cerrar
      </button>

      <!-- ğŸ”½ AquÃ­ se muestra la secciÃ³n existente -->
      <div id="configuracion-tienda-modal"></div>
    </div>
  </div>

  <!-- ğŸ“Š Panel de EstadÃ­sticas -->
  <section id="panel-estadisticas"
    style="display:none; margin-top:30px; background:#fff; padding:20px; border-radius:12px; box-shadow:0 6px 20px rgba(0,0,0,0.08);">
    <h2 style="text-align:center; color:#0b5ed7;">ğŸ“Š EstadÃ­sticas de Productos</h2>
    <canvas id="grafico-categorias" height="120"></canvas>
  </section>


  <!-- ğŸ“‡ Modal Registro de Clientes y Proveedores -->
  <div id="modalRegistroClientes" class="modal-overlay">
    <div class="modal-content">

      <button class="modal-close" onclick="cerrarModalRegistro()">âœ–</button>

      <h2 class="modal-title">ğŸ“‡ Registro de Clientes y Proveedores</h2>

      <div class="form-grid">
        <input id="nombreRegistro" placeholder="Nombre...">
        <input id="telefonoRegistro" placeholder="TelÃ©fono...">
        <select id="tipoRegistro">
          <option value="Cliente">Cliente</option>
          <option value="Proveedor">Proveedor</option>
        </select>
      </div>

      <textarea id="notaRegistro" placeholder="Notas..."></textarea>

      <button onclick="agregarRegistro()" class="btn-success">â• Guardar</button>

      <hr>

      <div class="modal-header-actions">
        <h3>ğŸ“„ Lista Registrada</h3>
        <button onclick="imprimirRegistros()" class="btn-primary">
          ğŸ–¨ï¸ Descargar PDF Lista
        </button>
      </div>

      <div class="tabla-responsive">
        <table id="tablaRegistros">
          <thead>
            <tr>
              <th>Nombre</th>
              <th>TelÃ©fono</th>
              <th>Tipo</th>
              <th>Notas</th>
              <th>Acciones</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>

    </div>
  </div>




  <script type="module" src="js/login.js"></script>
  <script type="module" src="js/admin.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>


</body>

</html>